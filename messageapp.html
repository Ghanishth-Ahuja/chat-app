<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

</head>
<body>
  <div class="container text-center w-50 bg-secondary p-5 mt-5">
    <div style="color: aliceblue;font-size:larger;">
      Hello
     <div style="display: flex; justify-content: center; align-items: center; ">
      <input class="form-control mt-5" style="width: 50%" placeholder="Your Name" id="name">
     </div>
     <div style="display: flex; justify-content: center; align-items: center; ">
      <input class="form-control mt-5" style="width: 50%" placeholder="Your Message" id="message">
     </div>

     <button id="donebtn" class="btn btn-success mt-4 w-50" style="font-size: 20px;">Done</button>
    </div>
  </div>
  <div id="mdiv" class="container w-50 p-5 mt-5">

  </div>
</body>


<script>
  getRequest()
  function appendDataMessage(Sender,message)
  {
    let m=document.createElement('h6');
    m.textContent=Sender;
    let p=document.createElement('p')
    p.textContent=message
    let messagearea=document.getElementById('mdiv')

    messagearea.appendChild(m);
    messagearea.appendChild(p);
  }



//button eventlistener


  document.getElementById('donebtn').addEventListener('click',()=>
{

  let message={Name:`${document.getElementById('name').value}`,Message:`${document.getElementById('message').value}`}
  postRequest(message);
  let p=document.getElementById('message').value
  let n=document.getElementById('name').value
    appendDataMessage(n,p);
    // getRequest();
})






// async function getRequest()
// {  
//   let req= await fetch('http://localhost:5500/messages');
//   let data = await req.json();
//   console.log(data);
//   data.forEach(element => {
//     appendDataMessage(element.Name,element.Message)
//   });
// }



// async function postRequest(data)
// {  
//   let req= await fetch('http://localhost:5500/messages',{
//     method:"POST",
//     headers:{
//       "Content-Type":"application/json"
//     },
//     body:JSON.stringify(data)
//   });

// }


const BASE_URL = "https://chat-app-idkb.onrender.com";

async function getRequest() {  
  let req = await fetch(`${BASE_URL}/messages`);
  let data = await req.json();
  console.log(data);
  data.forEach(element => {
    appendDataMessage(element.Name, element.Message);
  });
}

async function postRequest(data) {  
  let req = await fetch(`${BASE_URL}/messages`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });
}







  
    
  // if (req.ok) {
  //   console.log("Message sent successfully!");
  // } else {
  //   console.error("Failed to send message.");
  // }
  // console.log(req.status);
  




  </script>
</html>